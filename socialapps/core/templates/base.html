{% load i18n %}
{% load avatar_tags %}
<!DOCTYPE html>
<html lang="en"> 
<head>
	<title>.: BluFlog :.</title>
	<meta charset="utf-8" />
	{% block meta_redirec %}{% endblock %}
	<link rel="icon" type="image/png" href="#">
	<link rel="stylesheet" href="{{ STATIC_URL }}css/default.css">
	<link rel="stylesheet" href="{{ STATIC_URL }}css/socialstream.css">
	<link rel="stylesheet" href="{{ STATIC_URL }}css/socialapps_comments.css">
	<link rel="stylesheet" href="{{ STATIC_URL }}css/blue.css">	
	<link rel="stylesheet" href="{{ STATIC_URL }}css/dash.css">	
	<link rel="stylesheet" href="{{ STATIC_URL }}css/form.css">		
	<!--
		TODO profile.css is included because of the little grey bubbles used in other places, put that style in default.css
	-->
    <link rel="stylesheet" href="{{ STATIC_URL }}css/profile.css">

	<link rel="stylesheet" href="{{ STATIC_URL }}css/facebox.css">
	<link rel="stylesheet" href="{{ STATIC_URL }}css/movingboxes.css">
    <link href="{{STATIC_URL}}css/jquery-ui-1.8.13.custom.css" rel="stylesheet" type="text/css">
    <link href="{{STATIC_URL}}css/jquery.tagit.css" rel="stylesheet" type="text/css">
	<link rel='stylesheet' type='text/css' href='{{ STATIC_URL }}css/form.css' />
	<link rel="stylesheet" type='text/css' href="{{ STATIC_URL }}css/jquery.cleditor.css"/>
	{% block extra_css %}{% endblock %}

	<script type="text/javascript" src="{{ STATIC_URL }}js/jquery-1.5.2.min.js"></script>
	<script type="text/javascript" src="{{ STATIC_URL }}js/jquery-ui-1.8.6.custom.min.js"></script>
	<script type="text/javascript" src="{{ STATIC_URL }}js/socialapps.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/socialstream.js"></script>	
	<script type="text/javascript" src="{{ STATIC_URL }}js/comments.js"></script>
	<script type="text/javascript" src="{{ STATIC_URL }}js/facebox.js"></script>
	<script type="text/javascript" src="{{ STATIC_URL }}js/jquery.jqtransform.js"></script>	
	<script type="text/javascript" src="{{ STATIC_URL }}js/jquery.tmpl.min.js"></script>	
	<script type="text/javascript" src="{{ STATIC_URL }}js/jquery.form.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/tag-it.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/jquery.cleditor.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/jquery.movingboxes.min.js"></script>
	{% if object %}
		<script type="text/javascript" src="{{ STATIC_URL }}js/jquery.cleditor.extimage.js"></script>
		<script type="text/javascript">
			$.cleditor.buttons.image.uploadUrl = '{% url base_create object.get_absolute_url "image" %}';
			$.cleditor.buttons.image.popupContent =	
				'<div class="browser-tabs"><ul>' +
				'<li><a href="#existing">{% trans "Choose an existing one" %}</a></li>' +
				'<li><a href="#upload">{% trans "Upload from your computer" %}</a></li>' +
				'<li><a href="#url">{% trans "Url from a external image" %}</a></li>' +				
				'</ul>' +
				'<div id="existing">'+
				'<iframe width="500" height="250" name="existing" style="border:1px solid #CCC;" src="{% url ajax_browser object.get_absolute_url "image" %}" /></div>' +
				'<div id="upload"><iframe style="width:0;height:0;border:0;" name="__upload_iframe" />' +
				'<form method="post" enctype="multipart/form-data" action="" target="__upload_iframe">' +
				"{% csrf_token %}" + 			
				'<input id="id_image" name="image" type="file" /></form></div>' +
				'<div id="url">' +
				'<input type="text" class="url" size="40" value="" /></div>' +				
				'</div>' +				
				'<input type="button" value="Submit"/>';
				
			$.cleditor.buttons.link.popupContent = 
				'<div class="browser-tabs"><ul>' +
				'<li><a href="#link-url">{% trans "External url" %}</a></li>' +								
				'<li><a href="#existing-url">{% trans "Choose an existing object to link" %}</a></li>' +
				'</ul>' +
				'<div id="existing-url">'+							
				'<iframe width="500" height="250" name="existing" style="border:1px solid #CCC;" src="{% url ajax_browser object.get_absolute_url None %}" />' +
				'</div>' +
				'<div id="link-url">' +					
				'<input type="text" class="url" size="40" value="" /></div>' +
				'</div>' +
				'<input type="button" class="save-link" value="Submit"/>';	
		</script>
	{% endif %}
	{% block extra_js %}{% endblock %}

	<script type="text/javascript">

        //TODO: Explain why is this thing outside the document.ready() callback?
        $(function() {
			var delay = 0;
          	if (document.body.id == 'dash') {
				$('#navigation > li').each(function(e) {
					$('a', this)
        				.fadeTo(delay, 1)
        				.animate({marginLeft:'-8px'}, 600)
        				.animate({marginLeft:"-85"}, 600);
      					delay += 100;
    				});
			}
            else {	$('#navigation a').stop();	}                        
            $('#navigation > li').hover(
                function () {
                    $('a',$(this)).stop().animate({'marginLeft':'-8px'},200);
                },
                function () {
                    $('a',$(this)).stop().animate({'marginLeft':'-85px'},200);
                }
            );
        });
	</script>
	{% block extra_script  %}{% endblock %}	

    <!--[if IE]>
	<script type="text/javascript" src="{{ STATIC_URL }}js/fixed.js"></script>
		<script type="text/javascript" src="{{ STATIC_URL }}js/jquery.corner.js"></script>
	<![endif]-->	
  
    <!--[if IE 8]>
    <script src="http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE8.js" type="text/javascript"></script>
	    <![endif]-->

</head>
<body id="{% block body_id %}{% endblock %}">
	<ul id="navigation">
		<li> <a href="/"><img class="dash" src="{{ STATIC_URL }}/images/home-64-white.png"></a></li>
		<li><a href="/calendar/" title="Calendar"><img class="calendar" src="{{ STATIC_URL }}images/calendar-64-white.png"></a></li>
		<li><a href="/courses/" title="Courses"><img class="dash" src="{{ STATIC_URL }}images/sections-64-white.png"></a></li>
		<li><a href="/spaces/" title="Spaces"><img class="dash" src="{{ STATIC_URL }}images/spaces-64-white.png"></a></li>
		<li><a href="/profiles/" title="Profiles"><img class="dash" src="{{ STATIC_URL }}images/users-64-white.png"></a></li>
	</ul>
    <header>

  	<div class='container' style='position:relative;'>
  	<div class='subhead'>
	<a href="/"><img src="{{ STATIC_URL }}images/Blufrog.png" width="150px" height="39px"></a>
	<div id="form_avatar">
	        {% if messages_new_count %}
	        	<span class = "message-alert"></span>		    
            {% endif %}
			<form action="/search/" method="get" class="search_form">
				<input type="text" name="query" value="" autocomplete="off" placeholder="Search" id="header_input">
			</form>
			{% comment %}
			para poner el destello para nuevas notificaciones al rededor del avatar es necesario esta condicion:
			{% if messages_new_count or profile_new_count %} cambiar bandera del js {% endif %}
			esto cambiara a futuro con el realtime, ya que esta tarea se encargara un modulo de notificaciones (Task/Queue)
			{% endcomment %}
        	&nbsp;&nbsp;&nbsp;&nbsp;	<h2 class="trigger"><a href="#"><img src="{% avatar_url user 30 %}" width="30" height="30"/></a></h2>

		</div> 
        <div class="messages-all">
    	  {% if messages %}
    	  <ul class="messages">
    		  {% for message in messages %}
    		  <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    		  {% endfor %}
    	  </ul>
    	  {% endif %}
    	</div>			
	</div>
	</div>
	<div class="toggle_container" >
		<div class="personal-bar">
			<ul>
			    <li>						       
			        <a {% ifequal site_section "messages_inbox" %} class="selected" {% endifequal %}
				       href="/messages/"> <span class="ui-icon ui-icon-mail-closed"></span>
				       {% if messages_new_count %}<h1>{{ messages_new_count }}</h1>{% endif %}
				       Messages 
				    </a>
			    </li>
			    <li><a {% ifequal site_section "profile_detail" %} class="selected" {% endifequal %}
				       href="{% url profile_view user %}"><span class="ui-icon ui-icon-person"></span>Profile</a></li>
			    <li><a {% ifequal site_section "profile_settings" %} class="selected" {% endifequal %}
				       href="#"><span class="ui-icon ui-icon-wrench"></span>Settings</a></li>
			    <li><a href="{% url auth_logout %}"><span class="ui-icon ui-icon-power"></span>Exit</a></li>
			</ul>
		</div>
	</div>
	</header> 
	<div id="body">
        <div class="content_wraper">
			<div id="content">
			    {% block extra_messages %}{% endblock %}
			    <div id="content-tabs-wrapper">
    			    {% block content_tabs %}
    			    {% endblock %}
		        </div>
			    {% block content %}
				{% endblock %}							
			</div>
        </div>
        <div class="footer">
    		<p>BluFrog - <a href = "http://iservices.com.mx" target="_blank">iServices de M&eacute;xico</a></p>
        </div>
    </div>
   
</body>
</html>
